// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

// output = "./node_modules/.prisma/client"
//   output = "../node_modules/.prisma/client"
// C:\Users\willw\code\scrolly.page\node_modules\.pnpm\@prisma+client@5.22.0_prisma@5.22.0\node_modules\.prisma\client\index.d.ts
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ScrollDirection {
  Horizontal
  Vertical
}

enum EffectKind {
  StickToPage
  FadeIn
  FadeOut
  SlideIn
  SlideOut
  ZoomIn
  ZoomOut
  RotateIn
  RotateOut
}

enum ButtonKind {
  Standard
  Rounded
  Pill
  Block
  Realistic
  Offset
}

enum ShapeKind {
  Ellipse
  Rectangle
  Triangle
  Pentagon
  Hexagon
  Star
  Heart
  Diamond
  Explosion
  Crescent
  Speech
  Cloud
  Rainbow
  Kapow
  Flower
  Sticker
  Flare
}

enum ShapeStrokeKind {
  Solid
  Dashed
  Dotted
  None
}

enum ShapeFillKind {
  Solid
  Hatchure
  CrossHatch
  None
}

enum EffectDirection {
  Forwards
  Backwards
}

enum TriggerReason {
  ScreenStart
  ScreenMiddle
  ScreenEnd
  BeforeEnter
  WithPrevious
  AfterPrevious
  OnPageLoad
}

enum PartTag {
  Box
  Image
  Note
  Text
  Video
  Shape
  Button
  Tape
  // Mesh
}

enum TextDecoration {
  None
  Underline
  Overline
  LineThrough
}

model Site {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy         String
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  editedAt          DateTime?
  name              String
  slug              String    @unique
  domain            String?   @unique
  title             String
  description       String
  googleAnalyticsId String
  favicon           String
  ogImage           String
  pages             Page[]
  versions          Version[] @relation("SiteVersions")
  liveVersionId     String?   @db.Uuid
  liveVersion       Version?  @relation(fields: [liveVersionId], references: [id])
}

model Version {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  slug      String   @unique
  siteId    String   @db.Uuid
  site      Site     @relation(fields: [siteId], references: [id], onDelete: Cascade, name: "SiteVersions")
  pages     Page[]
  Site      Site[]
}

model Page {
  id                 String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy          String
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt
  title              String
  description        String
  ogImage            String
  path               String
  scrollDirection    ScrollDirection
  backgroundColor    String
  minWidth           Int
  minHeight          Int
  maxWidth           Int
  maxHeight          Int
  siteId             String          @db.Uuid
  site               Site            @relation(fields: [siteId], references: [id], onDelete: Cascade)
  parts              Part[]
  tiles              Tile[]
  groups             Group[]
  effects            Effect[]
  linkStyles         LinkStyle[]
  previewImage       String?
  versionId          String?         @db.Uuid
  version            Version?        @relation(fields: [versionId], references: [id], onDelete: Cascade)
}

model Group {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  pageId    String   @db.Uuid
  page      Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
  parts     Part[]
  effects   Effect[]
}

model Part {
  id              String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy       String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  tag             PartTag
  src             String
  srcWidth        Float
  srcHeight       Float
  left            Float
  top             Float
  width           Float
  height          Float
  rotateZ         Float
  opacity         Float
  rank            String
  innerHtml       String
  fontSize        Float
  backgroundColor String
  stretched       Boolean
  aspectLocked    Boolean
  fontFamily      String
  pageId          String   @db.Uuid
  page            Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
  effects         Effect[]
  groupId         String?  @db.Uuid
  group           Group?   @relation(fields: [groupId], references: [id])

  buttonKind         ButtonKind
  href               String

  shapeKind          ShapeKind
  shapeStrokeKind    ShapeStrokeKind
  shapeStrokeWidth   Float
  shapeStrokeColor   String
  shapeFillColor     String
  shapeFillKind      ShapeFillKind
  shapeFillWidth     Float
  shapeHatchureGap   Float
  shapeHatchureAngle Float
  shapeRoughness     Float
}

model Effect {
  id                 String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy          String
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt
  kind               EffectKind
  startWhen          TriggerReason
  direction          EffectDirection
  rank               String
  deltaParallel      Float
  deltaPerpendicular Float
  deltaRotateZ       Float
  scalarOpacity      Float
  scalarScale        Float
  distancePx         Int
  pageId             String          @db.Uuid
  page               Page            @relation(fields: [pageId], references: [id], onDelete: Cascade)
  partId             String?         @db.Uuid
  part               Part?           @relation(fields: [partId], references: [id], onDelete: Cascade)
  groupId            String?         @db.Uuid
  group              Group?          @relation(fields: [groupId], references: [id], onDelete: Cascade)
}

model Tile {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  xi        Int
  yi        Int
  url       String
  pageId    String   @db.Uuid
  page      Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
}

model LinkStyle {
  id              String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdBy       String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  pageId          String   @db.Uuid
  page            Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
  name            String
  color           String
  decoration      TextDecoration
  hoverColor      String
  hoverDecoration TextDecoration
  isDefault       Boolean
  rank            String
  className       String
}
